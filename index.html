<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Sudoku</title>
	
	<script type="text/javascript" src="cell.js"></script>
	<!--
	<script type="text/javascript" src="CentreBox.js"></script>
	<script type="text/javascript" src="box.js"></script>
	-->
</head>
<body>
<p>Instructions</p>
<canvas id="platformCanvas" width="450" height="450"></canvas>

<script>
let canvas;
let context;
let list;
let groups;
//let columns
canvas=document.getElementById("platformCanvas");
context=canvas.getContext("2d");
let cells;
let unitLength=Math.floor(smaller(canvas.width,canvas.height)/9);

window.onload=function() {
	setup();
    //document.addEventListener("keydown",keyPush);
    //setInterval(game,1000/15);
}
function setup(){
	background(255,255,255);
	setBorders();
	cells=createCells();
	list=makeRandomList();
	groups=write(list,cells);
}
function createCells(){
	let newCells=make2DArray(9,9);
	for(let i=0;i<9;i++){
		for(let j=0;j<9;j++){
			newCells[i][j]=new cell(i*unitLength,j*unitLength,unitLength);
		}
	}
	return newCells;
}
function makeGroup(x1,y1,x2,y2,allCells){
	let cells=new Array(9);
	let k=0;
	for(let i=x1;i<x2+1;i++){
		for(let j=y1;j<y2+1;j++){
			cells[k]= allCells[i] [j];
			k++;
		}
	}
	return cells;
}

function writeToGroup(list,group){
	for(let i=0;i<list.length;i++){
		group[i].write(list[i]);
	}
}

function smaller(a,b){
	return a<b?a:b;
}

function make2DArray(row,col){
	let arr=new Array(row);
	for(let i=0;i<row;i++){
		arr[i]=new Array(col);
	}
	return arr;
}

function randomise(number){//returns randomly number from 0 to (number-1) inclusive
	return Math.floor((Math.random() * number));
}
function shuffle(arr){
	let randomArr=copyArr(arr);
	let length=arr.length;
	for(let i=0;i<length;i++){
		target=randomise(length);
		temp=randomArr[i];
		randomArr[i]=randomArr[target];
		randomArr[target]=temp;
	}
	return randomArr;
}
function copyArr(Arr){
	let copy=new Array(Arr.length);
	for(let i=0;i<Arr.length;i++){
		copy[i]=Arr[i];
	}
	return copy;
}
function write(list,cells){
	let points=[0,0,2,2,  3,0,5,2,  6,0,8,2,  0,3,2,5,  3,3,5,5,  6,3,8,5,  0,6,2,8,  3,6,5,8,  6,6,8,8];
	let k=0;
	let groups=new Array(9);
	for(let i=0;i<36;i+=4){
		groups[k]=makeGroup(points[i],points[i+1],points[i+2],points[i+3],cells);
		console.log(k+" "+i+" "+points[i]+" "+points[i+1]+" "+points[i+2]+" "+points[i+3])
		writeToGroup(list[k],groups[k]);
		k++;
	}
	return groups;
}
function makeRandomList(){
	let list=new Array(9);
	let numbers=new Array(9);
	for(let i=0;i<9;i++){
		numbers[i]=i+1;
	}
	for(let i=0;i<9;i++){
		list[i]=shuffle(numbers);
	}
	return list;
}
function background(r,g,b){
	context.fillStyle= "rgb(" +r+ "," +g+ "," +b+")";
	context.fillRect(0,0,canvas.width,canvas.height);
}
function setBorders(){
	context.lineWidth=8;
	context.fillStyle= "black";
	context.rect(0,0,canvas.width,canvas.height);
	context.stroke();
	drawLine(0,3*unitLength,9*unitLength,3*unitLength,);
	drawLine(0,6*unitLength,9*unitLength,6*unitLength,);
	drawLine(3*unitLength,0,3*unitLength,9*unitLength,);
	drawLine(6*unitLength,0,6*unitLength,9*unitLength,);
}

function drawLine(x1,y1,x2,y2){
	context.lineWidth=3;
	context.beginPath()
	context.moveTo(x1,y1);
	context.lineTo(x2,y2);
	context.stroke();
}

</script>
</body>
</html>